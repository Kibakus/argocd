# –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞ –±–∞–∑–µ Kubernetes –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π MVP –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –Ω–∞ –±–∞–∑–µ —Å–∞–º–æ—É–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞ (self-hosted). –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –∏ CI/CD.

**–û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: Google Cloud Platform Microservices Demo (Online Boutique) ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω–∞, —Å–æ—Å—Ç–æ—è—â–µ–µ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —è–∑—ã–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—é Kubernetes
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ production-ready –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ CI/CD
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞–≤—ã–∫–æ–≤ —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ DevOps
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –¥–ª—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

```
Internet
   ‚Üì
Router (NAT 1: 80, 443, 32000 ‚Üí Windows Host)
   ‚Üì
Windows Host (VMware Workstation - NAT 2: 192.168.50.0/24)
   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Kubernetes Cluster (HA Setup)               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                     ‚îÇ
‚îÇ  Control Plane (3 nodes - HA):                      ‚îÇ
‚îÇ  ‚îú‚îÄ cp1 (192.168.50.111)                            ‚îÇ
‚îÇ  ‚îú‚îÄ cp2 (192.168.50.112)                            ‚îÇ
‚îÇ  ‚îî‚îÄ cp3 (192.168.50.113)                            ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  Worker Nodes (3 nodes):                            ‚îÇ
‚îÇ  ‚îú‚îÄ worker1 (192.168.50.121)                        ‚îÇ
‚îÇ  ‚îú‚îÄ worker2 (192.168.50.122)                        ‚îÇ
‚îÇ  ‚îî‚îÄ worker3 (192.168.50.123)                        ‚îÇ
‚îÇ                                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ  ‚îÇ     Kubernetes Namespaces                  ‚îÇ     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§     ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ argocd - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏       ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ ingress-nginx - ingress controller       ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ logging - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ       ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ microservices-demo - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ          ‚îÇ     ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ kube-system - —É—Ç–∏–ª–∏—Ç—ã —Å–∏—Å—Ç–µ–º—ã            ‚îÇ     ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –°–µ—Ç–µ–≤–∞—è —Ç–æ–ø–æ–ª–æ–≥–∏—è

```
                    Internet (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π IP)
                               ‚Üì
                   Router NAT (–¥–æ–º–∞/–ø—Ä–æ–≤–∞–π–¥–µ—Ä)
                        192.168.99.100
                    ‚Üô      ‚Üì      ‚Üì      ‚Üò
                  80    443   32000    (–¥—Ä—É–≥–∏–µ)
                    ‚Üò      ‚Üì      ‚Üì      ‚Üô
                      Windows Host (NAT 1)
                               ‚Üì
                    VMware Workstation NAT 2
                        192.168.50.0/24
                     192.168.50.2 (gateway)
                               ‚Üì
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚Üì                ‚Üì                ‚Üì
           cp1:111          cp2:112          cp3:113
          (control)        (control)        (control)
              ‚Üì                ‚Üì                ‚Üì
           6443            (–º–∞—Å—Ç–µ—Ä)          ---
              
              ‚Üì                ‚Üì                ‚Üì
           worker1:121      worker2:122      worker3:123
          31525 (HTTP)     31525 (HTTP)     31525 (HTTP)
          31526 (HTTPS)    31526 (HTTPS)    31526 (HTTPS)
          32000 (Grafana)  32000 (Grafana)  32000 (Grafana)
```

## üíª –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —É–∑–ª–æ–≤

| IP | –•–æ—Å—Ç–Ω–µ–π–º | CPU | RAM | SSD | –†–æ–ª—å |
|---|---|---|---|---|---|
| 192.168.50.100 | deploy | 2 | 2GB | 20GB | –£–∑–µ–ª –¥–ª—è –¥–µ–ø–ª–æ—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
| 192.168.50.111 | cp1 | 6 | 4GB | 20GB | Control Plane (Master) |
| 192.168.50.112 | cp2 | 6 | 4GB | 20GB | Control Plane (Master) |
| 192.168.50.113 | cp3 | 6 | 4GB | 20GB | Control Plane (Master) |
| 192.168.50.121 | worker1 | 4 | 2GB | 20GB | Worker Node |
| 192.168.50.122 | worker2 | 4 | 2GB | 20GB | Worker Node |
| 192.168.50.123 | worker3 | 4 | 2GB | 20GB | Worker Node |

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏

- **Hypervisor**: VMware Workstation
- **–û–° –¥–ª—è —É–∑–ª–æ–≤**: Debian GNU/Linux 13 (trixie) –∏–ª–∏ –∞–Ω–∞–ª–æ–≥
- **–°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**: 
  - Host NAT (Workstation) –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏
  - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ —á–µ—Ä–µ–∑ Windows Host –∏ Router

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è

- VMware Workstation —Å NAT —Å–µ—Ç—å—é 192.168.50.0/24
- 7 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
- SSH –¥–æ—Å—Ç—É–ø –º–µ–∂–¥—É —É–∑–ª–∞–º–∏
- Git –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- Python 3.13+ –¥–ª—è Ansible

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–∑–ª–æ–≤

–ù–∞ —É–∑–ª–µ **deploy** (192.168.50.100) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Ç–∏–ª–∏—Ç
sudo apt update
sudo apt install -y git python3-pip python3.13-venv curl wget

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–µ–π –¥–ª—è –±–µ–∑–ø–∞—Ä–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
ssh-keygen -t ed25519 -f ~/.ssh/id_ed25519 -N ""

# –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ –≤—Å–µ —É–∑–ª—ã
for node in 111 112 113 121 122 123; do
  ssh-copy-id -i ~/.ssh/id_ed25519.pub user@192.168.50.$node
done
```

### –®–∞–≥ 2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Kubernetes —Å –ø–æ–º–æ—â—å—é Kubespray

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Kubespray
git clone https://github.com/kubernetes-sigs/kubespray.git \
  --branch v2.29.0 --single-branch
cd kubespray/

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
cp -r inventory/sample inventory/mycluster
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `inventory/mycluster/inventory.ini`:

```ini
[all]
cp1 ansible_host=192.168.50.111 ip=192.168.50.111
cp2 ansible_host=192.168.50.112 ip=192.168.50.112
cp3 ansible_host=192.168.50.113 ip=192.168.50.113

worker1 ansible_host=192.168.50.121 ip=192.168.50.121
worker2 ansible_host=192.168.50.122 ip=192.168.50.122
worker3 ansible_host=192.168.50.123 ip=192.168.50.123

[kube_control_plane]
cp1
cp2
cp3

[etcd:children]
kube_control_plane

[kube_node]
worker1
worker2
worker3

[kube_ingress:children]
kube_node

[k8s_cluster:children]
kube_node
```

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
export http_proxy="http://192.168.99.101:18080"
export https_proxy="http://192.168.99.101:18080"
export no_proxy="localhost,127.0.0.1,::1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16,.local,.cluster.local,.svc"

ansible all -i inventory/mycluster/inventory.ini -m ping \
  --private-key=~/.ssh/id_ed25519

# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞
ansible-playbook -i inventory/mycluster/inventory.ini cluster.yml \
  -b -v --private-key=~/.ssh/id_ed25519 \
  -e http_proxy="http://192.168.99.101:18080" \
  -e https_proxy="http://192.168.99.101:18080" \
  -e no_proxy="localhost,127.0.0.1,::1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16,.local,.cluster.local,.svc"
```

### –®–∞–≥ 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ kubeconfig

–ù–∞ —É–∑–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (cp1):

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
scp -i ~/.ssh/id_ed25519 \
  user@192.168.50.111:/etc/kubernetes/admin.conf \
  ~/.kube/config

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞
kubectl cluster-info
kubectl get nodes
```

### –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Helm

```bash
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
```

### –®–∞–≥ 5: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ArgoCD

–î–æ–±–∞–≤—å—Ç–µ Helm —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
helm repo add argo https://argoproj.github.io/argo-helm
helm repo update
```

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `argocd-values.yaml`:

```yaml
repoServer:
  env:
    - name: HTTP_PROXY
      value: "http://192.168.99.101:18080"
    - name: HTTPS_PROXY
      value: "http://192.168.99.101:18080"
    - name: NO_PROXY
      value: "localhost,127.0.0.1,::1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16,.local,.cluster.local,.svc"
```

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
helm install my-argo-cd argo/argo-cd \
  --version 9.3.4 \
  --namespace argocd \
  --create-namespace \
  -f argocd-values.yaml
```

–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –¥–ª—è ArgoCD:

```bash
kubectl -n argocd get secret argocd-initial-admin-secret \
  -o jsonpath="{.data.password}" | base64 -d
```

### –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitOps

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π https://github.com/Kibakus/argocd.git
2. –í ArgoCD –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –°–æ–∑–¥–∞–π—Ç–µ Application —Ä–µ—Å—É—Ä—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

### 1. Ingress Controller (ingress-nginx)

**–í–µ—Ä—Å–∏—è**: 4.14.1  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`ingress.yaml`):
- –¢–∏–ø —Å–µ—Ä–≤–∏—Å–∞: NodePort
- –ü–æ—Ä—Ç—ã: 31525 (HTTP), 31526 (HTTPS), 32000 (Grafana)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ namespace

### 2. Storage Provisioner (local-path-provisioner)

**–í–µ—Ä—Å–∏—è**: 0.0.35  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–∞–∫ storage class –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —É–∑–ª–æ–≤
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 3. Monitoring Stack (Loki + Prometheus + Grafana)

**–í–µ—Ä—Å–∏—è**: 2.10.3  
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:

#### Prometheus
- –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Alertmanager –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π

#### Loki
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ª–æ–≥–æ–≤ —Å–æ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –ª–æ–≥–æ–≤

#### Promtail
- –ê–≥–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ –≤ Loki
- –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —É–∑–ª–µ

#### Grafana
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤
- –î–∞—à–±–æ—Ä–¥—ã –∏ –∞–ª–µ—Ä—Ç—ã
- **–î–æ—Å—Ç—É–ø**: http://kibakus.duckdns.org:32000
- **–ü–∞—Ä–æ–ª—å**: –ü–µ—Ä–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### 4. –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (microservices-demo)

**–ò—Å—Ç–æ—á–Ω–∏–∫**: Google Cloud Platform Microservices Demo  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –º–Ω–æ–≥–æ–∑–≤–µ–Ω–Ω–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã


**–î–æ—Å—Ç—É–ø**: 
- HTTPS: https://kibakus.duckdns.org (—Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)
- HTTP: http://kibakus.duckdns.org

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

### –î–∞—à–±–æ—Ä–¥—ã Grafana

1. **Node Exporter Full** - –º–µ—Ç—Ä–∏–∫–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
2. **Loki Kubernetes Logs** - –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ Loki

### –ú–µ—Ç—Ä–∏–∫–∏

–°–æ–±–∏—Ä–∞—é—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏ —É–∑–ª–æ–≤
- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–µ—Ç–∏
- –û–ø–µ—Ä–∞—Ü–∏–∏ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ –¥–∏—Å–∫–æ–≤
- Pod –º–µ—Ç—Ä–∏–∫–∏ (CPU, –ø–∞–º—è—Ç—å, —Å–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∑–∞–ø—Ä–æ—Å—ã, –∑–∞–¥–µ—Ä–∂–∫–∏, –æ—à–∏–±–∫–∏)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –í—Å–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ namespace, pod, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É

## üåê –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

### –í–Ω–µ—à–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ (—á–µ—Ä–µ–∑ Router NAT)

| –°–µ—Ä–≤–∏—Å | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| Microservices Demo (HTTP) | http://kibakus.duckdns.org | Online Boutique –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| Microservices Demo (HTTPS) | https://kibakus.duckdns.org | –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç |
| Grafana | http://kibakus.duckdns.org:32000 | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∞—à–±–æ—Ä–¥—ã |

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –≠—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è **—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è**, –∞ –Ω–µ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

**–ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**:
- –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –ü–∞—Ä–æ–ª–∏ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞—Ö (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ Secrets)
- HTTP —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Let's Encrypt —Å cert-manager
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å RBAC –∏ NetworkPolicies
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Secret Management (Sealed Secrets, Vault)
4. ...

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- **Control Plane**: 3 —É–∑–ª–∞ –¥–ª—è HA (etcd quorum)
- **Worker Nodes**: 3 —É–∑–ª–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: Local-path-provisioner (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)
- **–°–µ—Ç—å**: calico (default Kubespray)
`

## üìù –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä —Å HA Control Plane (3 –º–∞—Å—Ç–µ—Ä —É–∑–ª–∞)
- ‚úÖ 3 —Ä–∞–±–æ—á–∏—Ö —É–∑–ª–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ ArgoCD –¥–ª—è GitOps —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ Ingress Controller (nginx)
- ‚úÖ Loki Stack (Prometheus, Grafana, Loki, Promtail)
- ‚úÖ Google Microservices Demo –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚úÖ Local Path Storage provisioner
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ DDNS (kibakus.duckdns.org)
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üéì –ß—Ç–æ —è —É–∑–Ω–∞–ª

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª:

1. **Kubernetes Administration**
   - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ HA –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å –Ω—É–ª—è
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–∞–º–∏ –∏ —Å–µ—Ç–µ–≤—ã–º–∏ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏
   - RBAC –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º

2. **Infrastructure as Code**
   - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å Ansible/Kubespray
   - GitOps –ø–æ–¥—Ö–æ–¥ —Å ArgoCD
   - –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏

3. **Monitoring & Observability**
   - –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å Prometheus
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Loki
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å Grafana

4. **DevOps & Automation**
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - CI/CD –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
